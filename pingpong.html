<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>Monument Valley Inspired Vector Game</title>
<style>
  /* Сброс и базовые стили */
  * {
    box-sizing: border-box;
  }
  body, html {
    margin: 0; padding: 0;
    height: 100%;
    background: linear-gradient(135deg, #a0c4ff, #caf0f8);
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    user-select: none;
    overflow: hidden;
  }
  #game-container {
    width: 90vmin;
    height: 90vmin;
    max-width: 600px;
    max-height: 600px;
    background: #fff;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    position: relative;
  }
  svg {
    width: 100%;
    height: 100%;
    display: block;
  }
  /* Лестница */
  .stair {
    fill: url(#gradStair);
    stroke: #333;
    stroke-width: 2;
    filter: drop-shadow(1px 2px 1px rgba(0,0,0,0.1));
  }
  /* Персонаж */
  .character {
    fill: url(#gradChar);
    stroke: #b00020;
    stroke-width: 2;
    cursor: pointer;
    filter: drop-shadow(0 0 3px rgba(255, 89, 94, 0.7));
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  /* Текст подсказок */
  #info {
    position: absolute;
    bottom: 10px;
    width: 100%;
    text-align: center;
    font-size: 1rem;
    color: #555;
    user-select: none;
  }
  /* Адаптивный шрифт для мобильных */
  @media (max-width: 600px) {
    #info {
      font-size: 1.2rem;
      padding: 0 10px;
    }
  }
</style>
</head>
<body>

<div id="game-container" role="main" aria-label="Monument Valley inspired vector game">
  <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" id="gameSVG" aria-hidden="true" focusable="false">
    <defs>
      <!-- Градиенты -->
      <linearGradient id="gradStair" x1="0" y1="0" x2="1" y2="1">
        <stop offset="0%" stop-color="#ffd6a5" />
        <stop offset="100%" stop-color="#fdffb6" />
      </linearGradient>
      <radialGradient id="gradChar" cx="50%" cy="50%" r="50%">
        <stop offset="0%" stop-color="#ff595e" />
        <stop offset="100%" stop-color="#b00020" />
      </radialGradient>
    </defs>

    <!-- Невозможная лестница (упрощённая) -->
    <polygon class="stair" points="50,150 150,150 150,140 60,140" />
    <polygon class="stair" points="60,140 150,140 150,130 70,130" />
    <polygon class="stair" points="70,130 150,130 150,120 80,120" />
    <polygon class="stair" points="80,120 150,120 150,110 90,110" />
    <polygon class="stair" points="90,110 150,110 150,100 100,100" />

    <!-- Персонаж -->
    <circle class="character" cx="55" cy="145" r="6" id="player" aria-label="Игровой персонаж" />
  </svg>

  <div id="info" aria-live="polite"></div>
</div>

<script>
  (() => {
    const player = document.getElementById('player');
    const info = document.getElementById('info');
    const stairsY = [145, 135, 125, 115, 105];
    const stairsX = [55, 65, 75, 85, 95]; // Немного смещаем вправо при подъёме для эффекта перспективы
    let step = 0;

    // Определение устройства
    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

    // Обновление подсказок управления
    function updateInfo() {
      if (isMobile) {
        info.textContent = 'Свайпайте вверх/вниз для перемещения персонажа по лестнице';
      } else {
        info.textContent = 'Используйте стрелки ↑ и ↓ для перемещения персонажа по лестнице';
      }
    }

    updateInfo();

    // Функция перемещения персонажа
    function movePlayer(newStep) {
      if (newStep < 0 || newStep >= stairsY.length) return;
      step = newStep;
      // Плавное перемещение с помощью transform
      const dx = stairsX[step] - 55;
      const dy = stairsY[step] - 145;
      player.style.transform = `translate(${dx}px, ${dy}px)`;
    }

    // Управление с клавиатуры (ПК)
    if (!isMobile) {
      window.addEventListener('keydown', e => {
        if (e.key === 'ArrowUp') {
          movePlayer(step - 1);
          e.preventDefault();
        } else if (e.key === 'ArrowDown') {
          movePlayer(step + 1);
          e.preventDefault();
        }
      });
    }

    // Управление свайпами (мобильные)
    if (isMobile) {
      let touchStartY = null;
      let touchStartX = null;
      const threshold = 30; // Минимальное расстояние для свайпа

      window.addEventListener('touchstart', e => {
        if (e.touches.length === 1) {
          touchStartY = e.touches[0].clientY;
          touchStartX = e.touches[0].clientX;
        }
      });

      window.addEventListener('touchend', e => {
        if (touchStartY === null || touchStartX === null) return;
        const touchEndY = e.changedTouches[0].clientY;
        const touchEndX = e.changedTouches[0].clientX;
        const diffY = touchStartY - touchEndY;
        const diffX = touchStartX - touchEndX;

        if (Math.abs(diffY) > Math.abs(diffX)) {
          // Вертикальный свайп
          if (diffY > threshold) {
            // свайп вверх
            movePlayer(step - 1);
          } else if (diffY < -threshold) {
            // свайп вниз
            movePlayer(step + 1);
          }
        }
        // Можно добавить горизонтальные свайпы для других действий

        touchStartY = null;
        touchStartX = null;
      });
    }

    // Клик по персонажу — для ПК и мобильных (альтернативное управление)
    player.addEventListener('click', () => {
      // Циклический подъём по лестнице
      movePlayer((step + 1) % stairsY.length);
    });

  })();
</script>

</body>
</html>
