<!DOCTYPE html>
<html>
<head>
    <title>Heck.ai Racing</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #222;
        }
        #gameCanvas {
            background: #333;
        }
        #hud {
            position: fixed;
            top: 10px;
            left: 10px;
            color: white;
            font-family: Arial;
        }
    </style>
</head>
<>
    <div id="hud">Круг: <span id="lap">1</span>/2 | Скорость: <span id="speed">0</span> км/ч</div>
    <canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

// Настройка размеров
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// Игровые константы
const ROAD_WIDTH = 400;
const PLAYER_SPEED = 8;
const MAX_BOT_SPEED = 6;
const FINISH_LINE_Y = 100;
const LAPS_NEEDED = 2;

// Состояние игры
let gameState = {
    player: {
        x: canvas.width/2,
        y: canvas.height - 150,
        speed: 0,
        maxSpeed: 12,
        rotation: 0
    },
    bots: [],
    roadOffset: 0,
    lap: 1,
    finished: false
};

// Инициализация ботов
function initBots() {
    for(let i = 0; i < 5; i++) {
        gameState.bots.push({
            x: Math.random() * (ROAD_WIDTH - 60) + (canvas.width/2 - ROAD_WIDTH/2 + 30),
            y: -i * 200,
            speed: MAX_BOT_SPEED * Math.random(),
            lane: Math.floor(Math.random() * 3)
        });
    }
}

// Рисуем машину
function drawCar(x, y, color, rotation = 0) {
    ctx.save();
    ctx.translate(x, y);
    ctx.rotate(rotation);
    
    // Кузов
    ctx.fillStyle = color;
    ctx.fillRect(-15, -25, 30, 50);
    
    // Окна
    ctx.fillStyle = '#87CEEB';
    ctx.fillRect(-12, -22, 24, 20);
    
    // Колеса
    ctx.fillStyle = '#333';
    ctx.beginPath();
 ctx.arc(-12, 20, 8, 0, Math.PI*2);
    ctx.arc(12, 20, 8, 0, Math.PI*2);
    ctx.arc(-12, -20, 8, 0, Math.PI*2);
    ctx.arc(12, -20, 8, 0, Math.PI*2);
    ctx.fill();
    
    ctx.restore();
}

// Основной цикл игры
function gameLoop() {
    if(gameState.finished) return;

    // Очистка экрана
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Рисуем дорогу
    ctx.fillStyle = '#555';
    ctx.fillRect(canvas.width/2 - ROAD_WIDTH/2, 0, ROAD_WIDTH, canvas.height);
    
    // Рисуем разделительные линии
    ctx.strokeStyle = '#fff';
    ctx.setLineDash([40, 30]);
    ctx.beginPath();
 ctx.moveTo(canvas.width/2, gameState.roadOffset % 70);
    ctx.lineTo(canvas.width/2, canvas.height);
    ctx.stroke();

    // Обновление ботов
    gameState.bots.forEach(bot => {
        bot.y += bot.speed;
        if(bot.y > canvas.height) {
            bot.y = -100;
            bot.lane = Math.floor(Math.random() * 3);
        }
        bot.x = canvas.width/2 - ROAD_WIDTH/2 + 60 + bot.lane*140;
        drawCar(bot.x, bot.y, '#FF4444');
    });

    // Рисуем игрока
    drawCar(gameState.player.x, gameState.player.y, '#44CCFF', gameState.player.rotation);

    // Финишная линия
    ctx.fillStyle = '#fff';
    ctx.fillRect(canvas.width/2 - ROAD_WIDTH/2, FINISH_LINE_Y, ROAD_WIDTH, 5);

    // Проверка кругов
    if(gameState.player.y < FINISH_LINE_Y) {
        gameState.lap++;
        document.getElementById('lap').textContent = gameState.lap;
        gameState.player.y = canvas.height - 100;
        if(gameState.lap > LAPS_NEEDED) {
            gameState.finished = true;
            alert('Гонка зашена!');        }
    }

    // Обновление HUD
    document.getElementById('speed').textContent = Math.abs(Math.round(gameState.player.speed * 10));

    requestAnimationFrame(gameLoop);
}

// Управление
document.addEventListener('keydown', (e) => {
    if(e.key === 'ArrowLeft') {
        gameState.player.x = Math.max(canvas.width/2 - ROAD_WIDTH/2 + 40, gameState.player.x - 15);
        gameState.player.rotation = -0.1;
    }
    if(e.key === 'ArrowRight') {
        gameState.player.x = Math.min(canvas.width/2 + ROAD_WIDTH/2 - 40, gameState.player.x + 15);
        gameState.player.rotation = 0.1;
    }
});

document.addEventListener('keyup', () => {
    gameState.player.rotation = 0;
});

// Запуск игры
initBots();
gameLoop();
</script>
</body>
</html>
