<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ò–≥—Ä—ã: –ü–∏–Ω–ø–æ–Ω–≥, –°–∞–ø—ë—Ä –∏ –ì–æ–Ω–∫–∏ —Å –ø–∞–ª–∏—Ç—Ä–∞–º–∏</title>
  <style>
    :root {
      --bg-color: #000000;
      --text-color: #ffffff;
      --btn-bg: #0a84ff;
      --btn-bg-hover: #0066cc;
      --game-bg: #222222;
      --paddle-color: #ffffff;
      --ball-color: #ffffff;
      --net-color: #ffffff;
      --rating-bg: #111111;
      --rating-border: #ffffff;
      --ms-cell-bg: #555555;
      --ms-cell-revealed-bg: #bbbbbb;
      --ms-cell-flag-color: #f00;
      --ms-cell-text-color: black;
      --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      --transition-speed: 0.3s;
    }
    /* –°–±—Ä–æ—Å –∏ –±–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ */
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      background: var(--bg-color);
      color: var(--text-color);
      font-family: var(--font-family);
      user-select: none;
      height: 100vh;
      overflow: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      transition: background var(--transition-speed), color var(--transition-speed);
    }
    /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–Ω—é */
    #menu {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: var(--game-bg);
      z-index: 1000;
      padding: 20px;
      transition: background var(--transition-speed);
    }
    #menu h1 {
      font-size: 3.5rem;
      margin-bottom: 40px;
      font-weight: 700;
      letter-spacing: 2px;
      text-shadow: 0 0 8px rgba(10, 132, 255, 0.7);
    }
    #menu button {
      font-size: 1.5rem;
      padding: 15px 50px;
      margin: 15px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      background: var(--btn-bg);
      color: var(--text-color);
      box-shadow: 0 4px 15px rgba(10, 132, 255, 0.5);
      transition: background var(--transition-speed), box-shadow var(--transition-speed);
      user-select: none;
      font-weight: 600;
      letter-spacing: 1px;
      min-width: 220px;
      text-align: center;
    }
    #menu button:hover, #menu button:focus {
      background: var(--btn-bg-hover);
      box-shadow: 0 6px 20px rgba(0, 102, 204, 0.7);
      outline: none;
    }
    #settings {
      margin-top: 40px;
      text-align: center;
      color: var(--text-color);
      font-size: 1.1rem;
      user-select: none;
    }
    #settings label {
      margin-right: 12px;
      font-weight: 600;
      letter-spacing: 0.5px;
    }
    #settings select {
      font-size: 1.1rem;
      padding: 8px 14px;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      background: var(--btn-bg);
      color: var(--text-color);
      box-shadow: 0 3px 10px rgba(10, 132, 255, 0.5);
      transition: background var(--transition-speed), box-shadow var(--transition-speed);
      min-width: 180px;
      font-weight: 600;
    }
    #settings select:hover, #settings select:focus {
      background: var(--btn-bg-hover);
      box-shadow: 0 5px 15px rgba(0, 102, 204, 0.7);
      outline: none;
    }

    /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∏–≥—Ä */
    .game-wrapper {
      display: none;
      flex-grow: 1;
      background: var(--game-bg);
      position: relative;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
      padding: 20px;
      transition: background var(--transition-speed);
    }

    /* –ü–∏–Ω–ø–æ–Ω–≥ */
    #pong-container {
      display: flex;
      flex-grow: 1;
      flex-direction: row;
      overflow: hidden;
      max-width: 1200px;
      margin: 0 auto;
      width: 100%;
      box-sizing: border-box;
    }
    #game-container {
      position: relative;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: var(--game-bg);
      border-radius: 20px;
      box-shadow: 0 0 30px rgba(10, 132, 255, 0.6);
      padding: 20px;
      user-select: none;
    }
    canvas {
      background: var(--game-bg);
      border: 3px solid var(--rating-border);
      border-radius: 16px;
      display: block;
      touch-action: none;
      box-shadow: 0 0 20px rgba(10, 132, 255, 0.8);
      transition: border-color var(--transition-speed);
    }
    #score {
      font-size: 2rem;
      margin: 15px 0;
      letter-spacing: 12px;
      user-select: none;
      color: var(--text-color);
      font-weight: 700;
      text-shadow: 0 0 6px rgba(10, 132, 255, 0.8);
    }
    #pause-btn, #mode-btn, #pong-back-btn {
      position: absolute;
      background: #222a44;
      border: none;
      color: var(--text-color);
      font-size: 1rem;
      padding: 8px 16px;
      cursor: pointer;
      border-radius: 10px;
      user-select: none;
      z-index: 10;
      transition: background var(--transition-speed), box-shadow var(--transition-speed);
      box-shadow: 0 0 8px rgba(10, 132, 255, 0.6);
      font-weight: 600;
      letter-spacing: 0.5px;
    }
    #pause-btn:hover, #mode-btn:hover, #pong-back-btn:hover,
    #pause-btn:focus, #mode-btn:focus, #pong-back-btn:focus {
      background: #1a2240;
      box-shadow: 0 0 15px rgba(0, 102, 204, 0.9);
      outline: none;
    }
    #pause-btn {
      top: 12px;
      left: 12px;
    }
    #mode-btn {
      top: 12px;
      left: 120px;
    }
    #pong-back-btn {
      top: 12px;
      right: 12px;
    }
    #nickname-overlay {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.9);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 20;
      border-radius: 20px;
      padding: 20px;
      box-sizing: border-box;
      user-select: none;
    }
    #nickname-overlay input {
      font-size: 1.3rem;
      padding: 14px 20px;
      border-radius: 12px;
      border: none;
      width: 280px;
      margin-bottom: 20px;
      text-align: center;
      color: var(--text-color);
      background: #222a44;
      box-shadow: inset 0 0 8px rgba(10, 132, 255, 0.7);
      transition: background var(--transition-speed), box-shadow var(--transition-speed);
      font-weight: 600;
    }
    #nickname-overlay input::placeholder {
      color: #a0a0a0;
    }
    #nickname-overlay input:focus {
      background: #1a2240;
      box-shadow: inset 0 0 12px rgba(0, 102, 204, 0.9);
      outline: none;
    }
    #nickname-overlay button {
      font-size: 1.2rem;
      padding: 14px 40px;
      border-radius: 12px;
      border: none;
      background: var(--btn-bg);
      color: var(--text-color);
      cursor: pointer;
      user-select: none;
      font-weight: 700;
      letter-spacing: 1px;
      box-shadow: 0 0 15px rgba(10, 132, 255, 0.8);
      transition: background var(--transition-speed), box-shadow var(--transition-speed);
    }
    #nickname-overlay button:hover, #nickname-overlay button:focus {
      background: var(--btn-bg-hover);
      box-shadow: 0 0 25px rgba(0, 102, 204, 1);
      outline: none;
    }
    #rating {
      width: 320px;
      background: var(--rating-bg);
      border-left: 3px solid var(--rating-border);
      padding: 25px 20px;
      box-sizing: border-box;
      overflow-y: auto;
      color: var(--text-color);
      font-weight: 600;
      font-size: 1rem;
      border-radius: 0 20px 20px 0;
      box-shadow: inset 0 0 15px rgba(10, 132, 255, 0.5);
      user-select: none;
    }
    #rating h2 {
      margin-top: 0;
      text-align: center;
      font-weight: 700;
      border-bottom: 1px solid #555;
      padding-bottom: 12px;
      letter-spacing: 1px;
      font-size: 1.3rem;
      text-shadow: 0 0 6px rgba(10, 132, 255, 0.7);
    }
    #rating table {
      width: 100%;
      border-collapse: collapse;
      color: var(--text-color);
    }
    #rating th, #rating td {
      padding: 10px 8px;
      border-bottom: 1px solid #444;
      text-align: center;
      transition: background var(--transition-speed);
    }
    #rating th {
      background: #333;
      font-weight: 700;
      letter-spacing: 0.5px;
    }
    #rating tbody tr:hover {
      background: #222;
    }
    #rating::-webkit-scrollbar {
      width: 8px;
    }
    #rating::-webkit-scrollbar-thumb {
      background: #555;
      border-radius: 4px;
    }

    /* –°–∞–ø—ë—Ä */
    #minesweeper-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 30px 20px;
      flex-grow: 1;
      overflow-y: auto;
      background: var(--game-bg);
      width: 100%;
      box-sizing: border-box;
      color: var(--text-color);
      max-width: 480px;
      margin: 0 auto;
      border-radius: 20px;
      box-shadow: 0 0 30px rgba(10, 132, 255, 0.6);
      user-select: none;
      transition: background var(--transition-speed);
    }
    #ms-header {
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    #ms-status {
      font-size: 1.3rem;
      font-weight: 700;
      letter-spacing: 0.5px;
      text-shadow: 0 0 6px rgba(10, 132, 255, 0.7);
    }
    #ms-header button {
      background: #222a44;
      border: none;
      color: var(--text-color);
      font-size: 1rem;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 12px;
      user-select: none;
      transition: background var(--transition-speed), box-shadow var(--transition-speed);
      box-shadow: 0 0 10px rgba(10, 132, 255, 0.6);
      font-weight: 600;
      letter-spacing: 0.5px;
      min-width: 110px;
    }
    #ms-header button:hover, #ms-header button:focus {
      background: #1a2240;
      box-shadow: 0 0 20px rgba(0, 102, 204, 0.9);
      outline: none;
    }
    #ms-board {
      display: grid;
      grid-template-columns: repeat(9, 44px);
      grid-template-rows: repeat(9, 44px);
      gap: 4px;
      background: #333;
      border: 3px solid var(--rating-border);
      border-radius: 16px;
      user-select: none;
      box-shadow: inset 0 0 20px rgba(10, 132, 255, 0.7);
      transition: border-color var(--transition-speed);
    }
    .ms-cell {
      width: 44px;
      height: 44px;
      background: var(--ms-cell-bg);
      border-radius: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: 700;
      font-size: 22px;
      cursor: pointer;
      color: var(--text-color);
      user-select: none;
      position: relative;
      transition: background var(--transition-speed), color var(--transition-speed);
      box-shadow: 0 0 6px rgba(10, 132, 255, 0.4);
    }
    .ms-cell.revealed {
      background: var(--ms-cell-revealed-bg);
      color: var(--ms-cell-text-color);
      cursor: default;
      box-shadow: inset 0 0 10px rgba(0,0,0,0.2);
    }
    .ms-cell.flagged::after {
      content: "üö©";
      position: absolute;
      font-size: 22px;
      top: 2px;
      right: 4px;
      color: var(--ms-cell-flag-color);
      text-shadow: 0 0 4px rgba(255,0,0,0.8);
    }
    .ms-cell.mine {
      background: #f44336;
      color: black;
      box-shadow: inset 0 0 12px #b71c1c;
    }

    /* –ì–æ–Ω–∫–∏ */
    #racing-container {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 20px;
      flex-grow: 1;
      background: var(--game-bg);
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
      border-radius: 20px;
      box-shadow: 0 0 30px rgba(10, 132, 255, 0.6);
      user-select: none;
      transition: background var(--transition-speed);
      position: relative;
    }
    #racing-canvas {
      background: #111;
      border-radius: 20px;
      box-shadow: inset 0 0 20px rgba(10,132,255,0.7);
      display: block;
      margin-bottom: 20px;
      border: 3px solid var(--rating-border);
      max-width: 100%;
    }
    #racing-info {
      color: var(--text-color);
      font-size: 1.3rem;
      font-weight: 700;
      letter-spacing: 0.5px;
      text-shadow: 0 0 6px rgba(10, 132, 255, 0.7);
      margin-bottom: 20px;
      user-select: none;
    }
    #racing-back-btn {
      background: #222a44;
      border: none;
      color: var(--text-color);
      font-size: 1rem;
      padding: 10px 24px;
      cursor: pointer;
      border-radius: 12px;
      user-select: none;
      transition: background var(--transition-speed), box-shadow var(--transition-speed);
      box-shadow: 0 0 10px rgba(10, 132, 255, 0.6);
      font-weight: 600;
      letter-spacing: 0.5px;
      align-self: center;
      min-width: 120px;
    }
    #racing-back-btn:hover, #racing-back-btn:focus {
      background: #1a2240;
      box-shadow: 0 0 20px rgba(0, 102, 204, 0.9);
      outline: none;
    }
  </style>
</head>
<body>
  <!-- –ú–µ–Ω—é –≤—ã–±–æ—Ä–∞ –∏–≥—Ä—ã -->
  <div id="menu">
    <h1>–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É</h1>
    <button id="btn-pong" type="button">–ü–∏–Ω–ø–æ–Ω–≥</button>
    <button id="btn-minesweeper" type="button">–°–∞–ø—ë—Ä</button>
    <button id="btn-racing" type="button">–ì–æ–Ω–∫–∏</button>

    <div id="settings" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ü–≤–µ—Ç–æ–≤–æ–π –ø–∞–ª–∏—Ç—Ä—ã">
      <label for="palette-select">–¶–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞:</label>
      <select id="palette-select" title="–í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç–æ–≤—É—é –ø–∞–ª–∏—Ç—Ä—É" aria-describedby="palette-desc">
        <option value="random">–°–ª—É—á–∞–π–Ω—ã–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)</option>
        <option value="default">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è</option>
        <option value="sunset">–ó–∞–∫–∞—Ç</option>
        <option value="ocean">–û–∫–µ–∞–Ω</option>
        <option value="forest">–õ–µ—Å</option>
        <option value="neon">–ù–µ–æ–Ω</option>
      </select>
      <div id="palette-desc" style="font-size:0.9rem; margin-top:6px; color:#aaa;">
        –í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç–æ–≤—É—é –ø–∞–ª–∏—Ç—Ä—É –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ –∏–≥—Ä.
      </div>
    </div>
  </div>

  <!-- –ü–∏–Ω–ø–æ–Ω–≥ -->
  <div id="pong-container" class="game-wrapper" role="main" aria-label="–ò–≥—Ä–∞ –ü–∏–Ω–ø–æ–Ω–≥">
    <div id="game-container">
      <button id="pause-btn" title="–ü–∞—É–∑–∞" type="button" aria-pressed="false">–ü–∞—É–∑–∞</button>
      <button id="mode-btn" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º" type="button">–†–µ–∂–∏–º: –ü–ö</button>
      <button id="pong-back-btn" title="–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é" type="button">–ú–µ–Ω—é</button>
      <div id="score" aria-live="polite" aria-atomic="true">0 : 0</div>
      <canvas id="pong" width="800" height="500" aria-label="–ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ –ü–∏–Ω–ø–æ–Ω–≥"></canvas>

      <div id="nickname-overlay" role="dialog" aria-modal="true" aria-labelledby="nickname-label" style="display:flex;">
        <input type="text" id="nickname-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–∏–∫" maxlength="15" aria-describedby="nickname-desc" />
        <div id="nickname-label" style="position:absolute; left:-9999px;">–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫ –∏–≥—Ä–æ–∫–∞</div>
        <div id="nickname-desc" style="position:absolute; left:-9999px;">–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫ –¥–ª—è —Ä–µ–π—Ç–∏–Ω–≥–∞</div>
        <button id="start-btn" type="button">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
      </div>
    </div>

    <div id="rating" aria-label="–†–µ–π—Ç–∏–Ω–≥ –∏–≥—Ä–æ–∫–æ–≤">
      <h2>–†–µ–π—Ç–∏–Ω–≥ –∏–≥—Ä–æ–∫–æ–≤</h2>
      <table>
        <thead>
          <tr><th>–ú–µ—Å—Ç–æ</th><th>–ù–∏–∫</th><th>–ü–æ–±–µ–¥—ã</th></tr>
        </thead>
        <tbody id="rating-body">
          <!-- –†–µ–π—Ç–∏–Ω–≥ -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- –°–∞–ø—ë—Ä -->
  <div id="minesweeper-container" class="game-wrapper" role="main" aria-label="–ò–≥—Ä–∞ –°–∞–ø—ë—Ä">
    <div id="ms-header">
      <div id="ms-status" aria-live="polite" aria-atomic="true">–ú–∏–Ω: 10</div>
      <button id="ms-reset-btn" type="button">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
      <button id="ms-back-btn" type="button">–ú–µ–Ω—é</button>
    </div>
    <div id="ms-board" role="grid" aria-label="–ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ –°–∞–ø—ë—Ä"></div>
  </div>

  <!-- –ì–æ–Ω–∫–∏ -->
  <div id="racing-container" class="game-wrapper" role="main" aria-label="–ò–≥—Ä–∞ –ì–æ–Ω–∫–∏">
    <canvas id="racing-canvas" width="400" height="600" aria-label="–ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ –ì–æ–Ω–∫–∏"></canvas>
    <div id="racing-info" aria-live="polite" aria-atomic="true">–ü—Ä–æ–π–¥–µ–Ω–æ: 0 –º (0.00 –∫–º)</div>
    <button id="racing-back-btn" type="button">–ú–µ–Ω—é</button>
  </div>

  <script>
    // --- –ü–ê–õ–ò–¢–†–´ ---
    const palettes = {
      default: {
        '--bg-color': '#000000',
        '--text-color': '#ffffff',
        '--btn-bg': '#0a84ff',
        '--btn-bg-hover': '#0066cc',
        '--game-bg': '#222222',
        '--paddle-color': '#ffffff',
        '--ball-color': '#ffffff',
        '--net-color': '#ffffff',
        '--rating-bg': '#111111',
        '--rating-border': '#ffffff',
        '--ms-cell-bg': '#555555',
        '--ms-cell-revealed-bg': '#bbbbbb',
        '--ms-cell-flag-color': '#f00',
        '--ms-cell-text-color': 'black'
      },
      sunset: {
        '--bg-color': '#2c1a1a',
        '--text-color': '#ffd6ba',
        '--btn-bg': '#ff6f61',
        '--btn-bg-hover': '#e65b50',
        '--game-bg': '#3e2f2f',
        '--paddle-color': '#ffb997',
        '--ball-color': '#ff6f61',
        '--net-color': '#ffb997',
        '--rating-bg': '#4a3a3a',
        '--rating-border': '#ffb997',
        '--ms-cell-bg': '#7a4e4e',
        '--ms-cell-revealed-bg': '#ffd6ba',
        '--ms-cell-flag-color': '#ff6f61',
        '--ms-cell-text-color': '#4a2c2c'
      },
      ocean: {
        '--bg-color': '#001f3f',
        '--text-color': '#a7c7e7',
        '--btn-bg': '#0074d9',
        '--btn-bg-hover': '#005fa3',
        '--game-bg': '#003366',
        '--paddle-color': '#7fdbff',
        '--ball-color': '#39cccc',
        '--net-color': '#7fdbff',
        '--rating-bg': '#00264d',
        '--rating-border': '#7fdbff',
        '--ms-cell-bg': '#005580',
        '--ms-cell-revealed-bg': '#a7c7e7',
        '--ms-cell-flag-color': '#39cccc',
        '--ms-cell-text-color': '#00334d'
      },
      forest: {
        '--bg-color': '#0b3d0b',
        '--text-color': '#c6f6c6',
        '--btn-bg': '#2ecc40',
        '--btn-bg-hover': '#27ae34',
        '--game-bg': '#145214',
        '--paddle-color': '#a3d9a5',
        '--ball-color': '#2ecc40',
        '--net-color': '#a3d9a5',
        '--rating-bg': '#1e5a1e',
        '--rating-border': '#a3d9a5',
        '--ms-cell-bg': '#2a6f2a',
        '--ms-cell-revealed-bg': '#c6f6c6',
        '--ms-cell-flag-color': '#27ae34',
        '--ms-cell-text-color': '#144214'
      },
      neon: {
        '--bg-color': '#0f0f0f',
        '--text-color': '#39ff14',
        '--btn-bg': '#39ff14',
        '--btn-bg-hover': '#2ecc40',
        '--game-bg': '#121212',
        '--paddle-color': '#39ff14',
        '--ball-color': '#ff00ff',
        '--net-color': '#39ff14',
        '--rating-bg': '#1a1a1a',
        '--rating-border': '#39ff14',
        '--ms-cell-bg': '#222222',
        '--ms-cell-revealed-bg': '#39ff14',
        '--ms-cell-flag-color': '#ff00ff',
        '--ms-cell-text-color': '#121212'
      }
    };

    function applyPalette(name) {
      const palette = palettes[name] || palettes.default;
      for (const varName in palette) {
        document.documentElement.style.setProperty(varName, palette[varName]);
      }
    }

    const paletteSelect = document.getElementById('palette-select');
    function savePalette(name) {
      localStorage.setItem('selectedPalette', name);
    }
    function loadPalette() {
      const saved = localStorage.getItem('selectedPalette');
      if (saved && (saved === 'random' || palettes[saved])) {
        return saved;
      }
      return 'random';
    }

    function getRandomPalette(exclude = ['random']) {
      const keys = Object.keys(palettes).filter(k => !exclude.includes(k));
      return keys[Math.floor(Math.random() * keys.length)];
    }

    function applySelectedPalette(name) {
      if (name === 'random') {
        const randomPal = getRandomPalette();
        applyPalette(randomPal);
        return randomPal;
      } else {
        applyPalette(name);
        return name;
      }
    }

    let currentPalette = loadPalette();
    paletteSelect.value = currentPalette;
    if (currentPalette === 'random') {
      currentPalette = applySelectedPalette('random');
    } else {
      applyPalette(currentPalette);
    }

    paletteSelect.addEventListener('change', () => {
      const val = paletteSelect.value;
      if (val === 'random') {
        currentPalette = applySelectedPalette('random');
      } else {
        currentPalette = val;
        applyPalette(val);
      }
      savePalette(val);
    });

    // --- –ú–ï–ù–Æ ---
    const menu = document.getElementById('menu');
    const btnPong = document.getElementById('btn-pong');
    const btnMinesweeper = document.getElementById('btn-minesweeper');
    const btnRacing = document.getElementById('btn-racing');

    const pongContainer = document.getElementById('pong-container');
    const minesweeperContainer = document.getElementById('minesweeper-container');
    const racingContainer = document.getElementById('racing-container');

    function showMenu() {
      menu.style.display = 'flex';
      pongContainer.style.display = 'none';
      minesweeperContainer.style.display = 'none';
      racingContainer.style.display = 'none';
      racingGame.stop();
    }

    btnPong.onclick = () => {
      menu.style.display = 'none';
      minesweeperContainer.style.display = 'none';
      racingContainer.style.display = 'none';
      pongContainer.style.display = 'flex';
    };
    btnMinesweeper.onclick = () => {
      menu.style.display = 'none';
      pongContainer.style.display = 'none';
      racingContainer.style.display = 'none';
      minesweeperContainer.style.display = 'flex';
      minesweeperGame.init();
    };
    btnRacing.onclick = () => {
      menu.style.display = 'none';
      pongContainer.style.display = 'none';
      minesweeperContainer.style.display = 'none';
      racingContainer.style.display = 'flex';
      racingGame.start();
    };

    // --- –ü–ò–ù–ü–û–ù–ì --- (–∫–æ–¥ –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –æ—Ç–≤–µ—Ç–µ, –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏)
    // ... (–æ—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥ –ø–∏–Ω–ø–æ–Ω–≥–∞ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –æ—Ç–≤–µ—Ç–∞)

    // --- –°–ê–ü–Å–† --- (–∫–æ–¥ –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –æ—Ç–≤–µ—Ç–µ, –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏)
    // ... (–æ—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥ —Å–∞–ø—ë—Ä–∞ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –æ—Ç–≤–µ—Ç–∞)

    // --- –ì–û–ù–ö–ò ---
    const racingGame = (function(){
      const canvas = document.getElementById('racing-canvas');
      const ctx = canvas.getContext('2d');
      const info = document.getElementById('racing-info');
      const backBtn = document.getElementById('racing-back-btn');

      const width = canvas.width;
      const height = canvas.height;

      // –ü–æ–ª–æ—Å—ã: 4 –ø–æ–ª–æ—Å—ã, 2 –≤ –æ–¥–Ω—É —Å—Ç–æ—Ä–æ–Ω—É, 2 –≤ –¥—Ä—É–≥—É—é
      // –ò–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –æ–¥–Ω–æ–π –∏–∑ 4 –ø–æ–ª–æ—Å (0..3)
      // –ü–æ–ª–æ—Å—ã 0 –∏ 1 –∏–¥—É—Ç —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑ (–º–∞—à–∏–Ω—ã –¥–≤–∏–∂—É—Ç—Å—è –≤–Ω–∏–∑)
      // –ü–æ–ª–æ—Å—ã 2 –∏ 3 –∏–¥—É—Ç —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö (–º–∞—à–∏–Ω—ã –¥–≤–∏–∂—É—Ç—Å—è –≤–≤–µ—Ä—Ö)

      const laneCount = 4;
      const laneWidth = width / laneCount;

      // –ò–≥—Ä–æ–∫
      const player = {
        lane: 1, // —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–ª–æ—Å–∞ (1 –∏–ª–∏ 2 –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞)
        width: laneWidth * 0.7,
        height: 60,
        color: '#00ff00',
        y: height - 80,
      };

      // –î—Ä—É–≥–∏–µ –º–∞—à–∏–Ω—ã
      const carWidth = laneWidth * 0.7;
      const carHeight = 50;

      // –°–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è —Ç—Ä–∞—Å—Å—ã –∏ –º–∞—à–∏–Ω (–ø–∏–∫—Å–µ–ª–µ–π –≤ –∫–∞–¥—Ä)
      let speed = 4;

      // –ú–∞—à–∏–Ω—ã –Ω–∞ –ø–æ–ª–æ—Å–∞—Ö
      // –î–ª—è –ø–æ–ª–æ—Å 0 –∏ 1 –º–∞—à–∏–Ω—ã –¥–≤–∏–∂—É—Ç—Å—è –≤–Ω–∏–∑ (y —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è)
      // –î–ª—è –ø–æ–ª–æ—Å 2 –∏ 3 –º–∞—à–∏–Ω—ã –¥–≤–∏–∂—É—Ç—Å—è –≤–≤–µ—Ä—Ö (y —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è)
      // –ú–∞—à–∏–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤–∞—Ö –ø–æ –ø–æ–ª–æ—Å–∞–º
      let cars = [[], [], [], []];

      // –¢–∞–π–º–µ—Ä –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–∞—à–∏–Ω
      let spawnTimer = 0;
      const spawnInterval = 60; // –∫–∞–¥—Ä–æ–≤ –º–µ–∂–¥—É —Å–ø–∞–≤–Ω–æ–º

      // –í—Ä–µ–º—è –∏–≥—Ä—ã (–∫–∞–¥—Ä—ã)
      let frames = 0;
      let running = false;

      // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
      let leftPressed = false;
      let rightPressed = false;

      // –ó–≤—É–∫–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ

      function drawRoad() {
        ctx.fillStyle = '#222';
        ctx.fillRect(0, 0, width, height);

        // –†–∞–∑–º–µ—Ç–∫–∞ –ø–æ–ª–æ—Å
        ctx.strokeStyle = '#888';
        ctx.lineWidth = 2;
        for(let i=1; i<laneCount; i++) {
          const x = i * laneWidth;
          ctx.setLineDash([20, 20]);
          ctx.beginPath();
          ctx.moveTo(x, 0);
          ctx.lineTo(x, height);
          ctx.stroke();
        }
        ctx.setLineDash([]);
      }

      function drawCar(x, y, width, height, color) {
        ctx.fillStyle = color;
        ctx.beginPath();
        ctx.moveTo(x + width*0.5, y);
        ctx.lineTo(x + width*0.9, y + height*0.3);
        ctx.lineTo(x + width*0.9, y + height*0.7);
        ctx.lineTo(x + width*0.5, y + height);
        ctx.lineTo(x + width*0.1, y + height*0.7);
        ctx.lineTo(x + width*0.1, y + height*0.3);
        ctx.closePath();
        ctx.fill();

        // –§–∞—Ä—ã
        ctx.fillStyle = '#fff';
        ctx.beginPath();
        ctx.arc(x + width*0.3, y + height*0.15, 5, 0, Math.PI*2);
        ctx.arc(x + width*0.7, y + height*0.15, 5, 0, Math.PI*2);
        ctx.fill();
      }

      function spawnCar(lane) {
        // –°–æ–∑–¥–∞—ë–º –º–∞—à–∏–Ω—É –≤ –ø–æ–ª–æ—Å–µ lane
        // –î–ª—è –ø–æ–ª–æ—Å 0,1 y = -carHeight (—Å–≤–µ—Ä—Ö—É)
        // –î–ª—è –ø–æ–ª–æ—Å 2,3 y = height (—Å–Ω–∏–∑—É)
        const direction = lane < 2 ? 1 : -1;
        const y = direction === 1 ? -carHeight : height;
        const x = lane * laneWidth + (laneWidth - carWidth)/2;
        const color = getRandomColor();
        cars[lane].push({x, y, width: carWidth, height: carHeight, color, direction});
      }

      function getRandomColor() {
        // –í–æ–∑—å–º—ë–º —Ü–≤–µ—Ç –∏–∑ —Ç–µ–∫—É—â–µ–π –ø–∞–ª–∏—Ç—Ä—ã –¥–ª—è –º–∞—à–∏–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, paddle-color –∏–ª–∏ ball-color)
        // –ò–ª–∏ —Å–ª—É—á–∞–π–Ω—ã–π —è—Ä–∫–∏–π —Ü–≤–µ—Ç
        const colors = ['#e74c3c','#3498db','#f1c40f','#9b59b6','#e67e22','#1abc9c','#2ecc71'];
        return colors[Math.floor(Math.random()*colors.length)];
      }

      function updateCars() {
        for(let lane=0; lane<laneCount; lane++) {
          const direction = lane < 2 ? 1 : -1;
          for(let i = cars[lane].length - 1; i >= 0; i--) {
            const car = cars[lane][i];
            car.y += speed * direction;
            // –£–¥–∞–ª—è–µ–º –º–∞—à–∏–Ω—ã, –≤—ã—à–µ–¥—à–∏–µ –∑–∞ —ç–∫—Ä–∞–Ω
            if ((direction === 1 && car.y > height) || (direction === -1 && car.y + car.height < 0)) {
              cars[lane].splice(i, 1);
            }
          }
        }
      }

      function drawCars() {
        for(let lane=0; lane<laneCount; lane++) {
          for(const car of cars[lane]) {
            drawCar(car.x, car.y, car.width, car.height, car.color);
          }
        }
      }

      function drawPlayer() {
        const x = player.lane * laneWidth + (laneWidth - player.width)/2;
        drawCar(x, player.y, player.width, player.height, player.color);
      }

      function checkCollision() {
        const px = player.lane * laneWidth + (laneWidth - player.width)/2;
        const py = player.y;
        const pw = player.width;
        const ph = player.height;

        for(let lane=0; lane<laneCount; lane++) {
          for(const car of cars[lane]) {
            if (lane !== player.lane) continue;
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤
            if (px < car.x + car.width &&
                px + pw > car.x &&
                py < car.y + car.height &&
                py + ph > car.y) {
              return true;
            }
          }
        }
        return false;
      }

      function update() {
        if (!running) return;

        frames++;
        spawnTimer++;

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–º
        if (leftPressed && player.lane > 0) {
          player.lane--;
          leftPressed = false;
        }
        if (rightPressed && player.lane < laneCount - 1) {
          player.lane++;
          rightPressed = false;
        }

        // –°–ø–∞–≤–Ω –º–∞—à–∏–Ω
        if (spawnTimer >= spawnInterval) {
          spawnTimer = 0;
          // –°–ø–∞–≤–Ω–∏–º –º–∞—à–∏–Ω—É –≤ —Å–ª—É—á–∞–π–Ω–æ–π –ø–æ–ª–æ—Å–µ, –∫—Ä–æ–º–µ –ø–æ–ª–æ—Å—ã –∏–≥—Ä–æ–∫–∞ (—á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ)
          let laneToSpawn;
          do {
            laneToSpawn = Math.floor(Math.random() * laneCount);
          } while (laneToSpawn === player.lane);
          spawnCar(laneToSpawn);
        }

        updateCars();

        if (checkCollision()) {
          stop();
          alert(`–í—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å! –ü—Ä–æ–π–¥–µ–Ω–æ: ${getDistance()} –º (${(getDistance()/1000).toFixed(2)} –∫–º)`);
          showMenu();
        }
      }

      function draw() {
        ctx.clearRect(0, 0, width, height);
        drawRoad();
        drawCars();
        drawPlayer();
      }

      function gameLoop() {
        if (!running) return;
        update();
        draw();
        updateInfo();
        requestAnimationFrame(gameLoop);
      }

      function updateInfo() {
        const dist = getDistance();
        info.textContent = `–ü—Ä–æ–π–¥–µ–Ω–æ: ${dist} –º (${(dist/1000).toFixed(2)} –∫–º)`;
      }

      function getDistance() {
        // –ü—Ä–æ–π–¥–µ–Ω–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ (frames) –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏
        // –ü—É—Å—Ç—å 1 –∫–∞–¥—Ä = 1/60 —Å–µ–∫—É–Ω–¥—ã, —Å–∫–æ—Ä–æ—Å—Ç—å = 4 –ø–∏–∫—Å–µ–ª—è/–∫–∞–¥—Ä
        // –ü—É—Å—Ç—å 1 –ø–∏–∫—Å–µ–ª—å = 1 –º–µ—Ç—Ä (—É—Å–ª–æ–≤–Ω–æ)
        return Math.floor(frames * speed);
      }

      function start() {
        if (running) return;
        running = true;
        frames = 0;
        spawnTimer = 0;
        player.lane = 1;
        cars = [[], [], [], []];
        updateInfo();
        gameLoop();
      }

      function stop() {
        running = false;
      }

      // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏—à–∞–º–∏
      function onKeyDown(e) {
        if (!running) return;
        if (e.key === 'ArrowLeft' || e.key === 'a') {
          leftPressed = true;
          e.preventDefault();
        }
        if (e.key === 'ArrowRight' || e.key === 'd') {
          rightPressed = true;
          e.preventDefault();
        }
      }
      function onKeyUp(e) {
        if (!running) return;
        if (e.key === 'ArrowLeft' || e.key === 'a') {
          leftPressed = false;
          e.preventDefault();
        }
        if (e.key === 'ArrowRight' || e.key === 'd') {
          rightPressed = false;
          e.preventDefault();
        }
      }

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –≤—ã—Ö–æ–¥–∞
      backBtn.onclick = () => {
        stop();
        showMenu();
      };

      // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—à–∞—Ç–µ–ª–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∏ —É–±–∏—Ä–∞–µ–º –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ
      function addListeners() {
        window.addEventListener('keydown', onKeyDown);
        window.addEventListener('keyup', onKeyUp);
      }
      function removeListeners() {
        window.removeEventListener('keydown', onKeyDown);
        window.removeEventListener('keyup', onKeyUp);
      }

      // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ª—É—à–∞—Ç–µ–ª–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ/—Å—Ç–æ–ø–µ
      function startGame() {
        start();
        addListeners();
      }
      function stopGame() {
        stop();
        removeListeners();
      }

      return {
        start: startGame,
        stop: stopGame
      };
    })();

    // --- –ü–ò–ù–ü–û–ù–ì –∏ –°–ê–ü–Å–† –∫–æ–¥ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤ ---
    // –î–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é –∑–¥–µ—Å—å, –≤—Å—Ç–∞–≤—å—Ç–µ –∏—Ö –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –æ—Ç–≤–µ—Ç–∞.

  </script>
</body>
</html>
