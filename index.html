<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Пинг-понг на 4 игрока (Один файл)</title>
    <style>
        /* CSS стили */
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #222;
            font-family: 'Arial', sans-serif;
            overflow: hidden; /* Предотвращаем прокрутку */
        }

        #game-container {
            position: relative;
            width: 800px; /* Ширина игрового поля */
            height: 800px; /* Высота игрового поля */
            background-color: #000;
            border: 5px solid #eee;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.7);
            overflow: hidden; /* Важно для ракеток и мяча */
        }

        #game-board {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .paddle {
            position: absolute;
            background-color: #00FFFF; /* Бирюзовый */
            width: 100px; /* Длина ракетки */
            height: 20px; /* Толщина ракетки */
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }

        /* Расположение ракеток */
        #paddle-player { /* Нижняя ракетка (игрок) */
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
        }

        #paddle-bot1 { /* Верхняя ракетка (бот 1) */
            top: 0;
            left: 50%;
            transform: translateX(-50%);
        }

        #paddle-bot2 { /* Левая ракетка (бот 2) */
            left: 0;
            top: 50%;
            transform: translateY(-50%) rotate(90deg); /* Поворот для вертикальной ракетки */
        }

        #paddle-bot3 { /* Правая ракетка (бот 3) */
            right: 0;
            top: 50%;
            transform: translateY(-50%) rotate(90deg); /* Поворот для вертикальной ракетки */
        }

        #ball {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #FFD700; /* Золотой */
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
        }

        /* Стили для счета */
        .score {
            position: absolute;
            color: #fff;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .player-score {
            bottom: 20px;
            left: 20px;
        }

        .bot1-score {
            top: 20px;
            left: 20px;
        }

        .bot2-score {
            top: 20px;
            right: 20px;
        }

        .bot3-score {
            bottom: 20px;
            right: 20px;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="game-board">
            <!-- Ракетки -->
            <div id="paddle-player" class="paddle player"></div>
            <div id="paddle-bot1" class="paddle bot"></div>
            <div id="paddle-bot2" class="paddle bot"></div>
            <div id="paddle-bot3" class="paddle bot"></div>

            <!-- Мяч -->
            <div id="ball"></div>

            <!-- Счет -->
            <div id="score-player" class="score player-score">Игрок: 0</div>
            <div id="score-bot1" class="score bot1-score">Бот 1: 0</div>
            <div id="score-bot2" class="score bot2-score">Бот 2: 0</div>
            <div id="score-bot3" class="score bot3-score">Бот 3: 0</div>
        </div>
    </div>

    <script>
        // JavaScript код
        const gameBoard = document.getElementById('game-board');
        const ball = document.getElementById('ball');
        const paddlePlayer = document.getElementById('paddle-player');
        const paddleBot1 = document.getElementById('paddle-bot1'); // Верхний бот
        const paddleBot2 = document.getElementById('paddle-bot2'); // Левый бот
        const paddleBot3 = document.getElementById('paddle-bot3'); // Правый бот

        const scorePlayer = document.getElementById('score-player');
        const scoreBot1 = document.getElementById('score-bot1');
        const scoreBot2 = document.getElementById('score-bot2');
        const scoreBot3 = document.getElementById('score-bot3');

        const boardWidth = gameBoard.clientWidth;
        const boardHeight = gameBoard.clientHeight;
        const paddleWidth = paddlePlayer.clientWidth;
        const paddleHeight = paddlePlayer.clientHeight;
        const ballSize = ball.clientWidth;

        let ballX = boardWidth / 2 - ballSize / 2;
        let ballY = boardHeight / 2 - ballSize / 2;
        let ballSpeedX = 5; // Скорость мяча по X
        let ballSpeedY = 5; // Скорость мяча по Y

        let playerPaddleX = boardWidth / 2 - paddleWidth / 2;
        let bot1PaddleX = boardWidth / 2 - paddleWidth / 2;
        let bot2PaddleY = boardHeight / 2 - paddleWidth / 2; // Для вертикальных ракеток ширина становится высотой
        let bot3PaddleY = boardHeight / 2 - paddleWidth / 2;

        let playerScore = 0;
        let bot1Score = 0;
        let bot2Score = 0;
        let bot3Score = 0;

        // Обновление счета на экране
        function updateScores() {
            scorePlayer.textContent = `Игрок: ${playerScore}`;
            scoreBot1.textContent = `Бот 1: ${bot1Score}`;
            scoreBot2.textContent = `Бот 2: ${bot2Score}`;
            scoreBot3.textContent = `Бот 3: ${bot3Score}`;
        }

        // Инициализация позиции мяча и ракеток
        function resetBall() {
            ballX = boardWidth / 2 - ballSize / 2;
            ballY = boardHeight / 2 - ballSize / 2;
            // Случайное направление после сброса
            ballSpeedX = (Math.random() > 0.5 ? 1 : -1) * 5;
            ballSpeedY = (Math.random() > 0.5 ? 1 : -1) * 5;
            // Сброс скорости мяча до начальной
            const initialSpeed = 5;
            ballSpeedX = (ballSpeedX > 0 ? 1 : -1) * initialSpeed;
            ballSpeedY = (ballSpeedY > 0 ? 1 : -1) * initialSpeed;
        }

        // Движение игрока (стрелки влево/вправо)
        document.addEventListener('keydown', e => {
            if (e.key === 'ArrowLeft') {
                playerPaddleX = Math.max(0, playerPaddleX - 15); // Скорость движения игрока
            } else if (e.key === 'ArrowRight') {
                playerPaddleX = Math.min(boardWidth - paddleWidth, playerPaddleX + 15);
            }
            paddlePlayer.style.left = `${playerPaddleX}px`;
        });

        // Основной игровой цикл
        function gameLoop() {
            // Движение мяча
            ballX += ballSpeedX;
            ballY += ballSpeedY;

            // Обновление позиции мяча
            ball.style.left = `${ballX}px`;
            ball.style.top = `${ballY}px`;

            // Столкновение мяча с горизонтальными стенами (верх/низ)
            if (ballY <= 0) { // Верхняя стена (зона бота 1)
                // Проверяем столкновение с ракеткой бота 1
                if (ballX + ballSize > bot1PaddleX && ballX < bot1PaddleX + paddleWidth) {
                    ballSpeedY *= -1; // Отскок от ракетки бота 1
                    // Увеличиваем скорость мяча при отскоке
                    ballSpeedX *= 1.05;
                    ballSpeedY *= 1.05;
                } else {
                    // Мяч прошел мимо бота 1
                    playerScore++; // Игрок получает очко
                    resetBall();
                }
            } else if (ballY >= boardHeight - ballSize) { // Нижняя стена (зона игрока)
                // Проверяем столкновение с ракеткой игрока
                if (ballX + ballSize > playerPaddleX && ballX < playerPaddleX + paddleWidth) {
                    ballSpeedY *= -1; // Отскок от ракетки игрока
                    // Увеличиваем скорость мяча при отскоке
                    ballSpeedX *= 1.05;
                    ballSpeedY *= 1.05;
                } else {
                    // Мяч прошел мимо игрока
                    bot1Score++; // Бот 1 получает очко
                    resetBall();
                }
            }

            // Столкновение мяча с вертикальными стенами (лево/право)
            if (ballX <= 0) { // Левая стена (зона бота 2)
                // Для вертикальных ракеток, Y-координата мяча должна быть в пределах ракетки
                // paddleWidth здесь - это высота вертикальной ракетки
                if (ballY + ballSize > bot2PaddleY && ballY < bot2PaddleY + paddleWidth) {
                    ballSpeedX *= -1; // Отскок от ракетки бота 2
                    ballSpeedX *= 1.05;
                    ballSpeedY *= 1.05;
                } else {
                    // Мяч прошел мимо бота 2
                    bot3Score++; // Бот 3 получает очко
                    resetBall();
                }
            } else if (ballX >= boardWidth - ballSize) { // Правая стена (зона бота 3)
                if (ballY + ballSize > bot3PaddleY && ballY < bot3PaddleY + paddleWidth) { // paddleWidth здесь - это высота вертикальной ракетки
                    ballSpeedX *= -1; // Отскок от ракетки бота 3
                    ballSpeedX *= 1.05;
                    ballSpeedY *= 1.05;
                } else {
                    // Мяч прошел мимо бота 3
                    bot2Score++; // Бот 2 получает очко
                    resetBall();
                }
            }

            // Логика движения ботов (очень простая: следуют за мячом)
            // Бот 1 (верхний, горизонтальный)
            // Цель бота - чтобы центр его ракетки был напротив центра мяча
            const bot1TargetX = ballX + ballSize / 2 - paddleWidth / 2;
            if (bot1PaddleX < bot1TargetX) {
                bot1PaddleX = Math.min(bot1TargetX, bot1PaddleX + 3); // Скорость бота
            } else if (bot1PaddleX > bot1TargetX) {
                bot1PaddleX = Math.max(bot1TargetX, bot1PaddleX - 3);
            }
            // Ограничиваем движение бота в пределах поля
            bot1PaddleX = Math.max(0, Math.min(boardWidth - paddleWidth, bot1PaddleX));
            paddleBot1.style.left = `${bot1PaddleX}px`;

            // Бот 2 (левый, вертикальный)
            const bot2TargetY = ballY + ballSize / 2 - paddleWidth / 2; // paddleWidth здесь - это высота
            if (bot2PaddleY < bot2TargetY) {
                bot2PaddleY = Math.min(bot2TargetY, bot2PaddleY + 3);
            } else if (bot2PaddleY > bot2TargetY) {
                bot2PaddleY = Math.max(bot2TargetY, bot2PaddleY - 3);
            }
            bot2PaddleY = Math.max(0, Math.min(boardHeight - paddleWidth, bot2PaddleY));
            paddleBot2.style.top = `${bot2PaddleY}px`;

            // Бот 3 (правый, вертикальный)
            const bot3TargetY = ballY + ballSize / 2 - paddleWidth / 2;
            if (bot3PaddleY < bot3TargetY) {
                bot3PaddleY = Math.min(bot3TargetY, bot3PaddleY + 3);
            } else if (bot3PaddleY > bot3TargetY) {
                bot3PaddleY = Math.max(bot3TargetY, bot3PaddleY - 3);
            }
            bot3PaddleY = Math.max(0, Math.min(boardHeight - paddleWidth, bot3PaddleY));
            paddleBot3.style.top = `${bot3PaddleY}px`;

            updateScores();
            requestAnimationFrame(gameLoop); // Запускаем следующий кадр анимации
        }

        // Запуск игры
        resetBall(); // Устанавливаем мяч в начальную позицию
        updateScores(); // Обновляем счет
        gameLoop(); // Запускаем игровой цикл
    </script>
</body>
</html>
